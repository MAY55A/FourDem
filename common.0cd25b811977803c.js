"use strict";(self.webpackChunkFourDev_front=self.webpackChunkFourDev_front||[]).push([[592],{1569:(p,a,i)=>{i.d(a,{I:()=>u});class r{}var h=i(7489),o=i(8256),l=i(8722),n=i(7848),d=i(3196);let u=(()=>{class s{constructor(e,t,c){this.categoryService=e,this.projectService=t,this.notificationService=c,this.displayStyle="none",this.domains=["It","Comptabilit\xe9","Influence"],this.checkedDomains=[!1,!1,!1],this.categories=[],this.selectedCategories=new Set,this.project=new r}getCategories(){this.categories=[],this.checkedDomains.forEach((e,t)=>{e&&this.categoryService.getCategoriesByDomain(this.domains[t]).subscribe(c=>{this.categories.push(...c),this.checkedCategories=new Array(this.categories.length).fill(!1)})})}updateSelectedCategories(){this.selectedCategories=new Set,console.log(this.checkedCategories),this.checkedCategories.forEach((e,t)=>{e&&this.selectedCategories.add(this.categories[t])})}categoryIsIncluded(e){return this.project.categories?.map(t=>t.id).includes(e.id)}openProjectForm(){this.formType="Ajout",this.displayStyle="block"}closeProjectForm(){this.project=new r,this.categories=[],this.checkedDomains=[!1,!1,!1],this.success="",this.alert="",this.displayStyle="none"}checkFormFields(){this.alert="",this.project.title?this.project.description?this.project.description.length<150?this.alert="La description doit contenir au moins 150 caract\xe8res !":this.checkedDomains.includes(!0)||0!=this.project.categories.length?0==this.selectedCategories.size&&0==this.project.categories.length&&(this.alert="Vous devez choisir au moins une cat\xe9gorie !"):this.alert="Vous devez choisir au moins un domaine !":this.alert="Vous devez introduire une description de votre projet !":this.alert="Vous devez donner un titre \xe0 votre projet !"}submitAddProjectForm(e){this.checkFormFields(),this.alert||(this.project.proposer=e,this.project.categories=[...this.selectedCategories],this.projectService.createProject(this.project).subscribe(t=>{console.log("creating ..."),this.success="Projet propos\xe9 !",setTimeout(()=>{window.location.reload()},1e3)}))}editProject(e){this.project={...e},this.unmodifiedProject={...e},console.log(this.project),this.openProjectForm(),this.formType="Modification"}removeCategory(e){this.project.categories=this.project.categories.filter(t=>t.id!=e.id)}submitEditProjectForm(){this.checkFormFields(),this.selectedCategories.size>0&&(this.project.categories=this.project.categories.concat([...this.selectedCategories]),console.log(this.selectedCategories),console.log(this.project.categories)),console.log(this.project,this.unmodifiedProject),(0,h.isEqual)(this.project,this.unmodifiedProject)&&(this.alert="Aucune modification est affect\xe9e !"),this.alert||this.projectService.updateProjectAndNotify(this.project,"Modification").subscribe(()=>{console.log("updating ..."),this.success="Projet modifi\xe9 !",setTimeout(()=>{window.location.reload()},1e3)})}finishProject(e){e.status="termin\xe9",this.projectService.updateProjectAndNotify(e,"Finishing").subscribe(()=>{console.log("Project successfully finished !"),setTimeout(()=>{window.location.reload()},3e3)},t=>console.log(t))}deleteProject(e){confirm("Si vous supprimez ce projet, vous ne pouvez jamais le r\xe9cup\xe9rer, vouler vous le supprimer ?")&&this.projectService.deleteProjectAndNotify(e).subscribe(()=>{console.log("Project deleted successfully"),window.location.reload()},t=>console.log(t))}static#e=this.\u0275fac=function(t){return new(t||s)(o.LFG(l.H),o.LFG(n.Y),o.LFG(d.g))};static#t=this.\u0275prov=o.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})()}}]);